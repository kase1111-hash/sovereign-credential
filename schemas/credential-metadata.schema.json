{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://sovereign-credential.io/schema/v1.0/credential.json",
  "title": "Sovereign Credential Metadata",
  "description": "Schema for credential metadata stored on IPFS. Follows SPEC.md Appendix B.",
  "type": "object",
  "required": ["name", "description", "claimType", "issuer"],
  "properties": {
    "name": {
      "type": "string",
      "description": "Human-readable name of the credential",
      "examples": ["Oregon Driver's License", "Stanford University Degree"]
    },
    "description": {
      "type": "string",
      "description": "Detailed description of what this credential represents",
      "examples": ["Class C motor vehicle operator license issued by Oregon DMV"]
    },
    "image": {
      "type": "string",
      "format": "uri",
      "description": "IPFS URI or HTTPS URL for credential image/template",
      "examples": ["ipfs://Qm.../license-template.png"]
    },
    "claimType": {
      "type": "string",
      "description": "Claim type identifier (matches ClaimTypes.sol constants)",
      "pattern": "^0x[0-9a-fA-F]{1,2}$|^[A-Z_]+$",
      "examples": ["LICENSE_OPERATOR", "0x11"]
    },
    "claimTypeId": {
      "type": "string",
      "pattern": "^0x[0-9a-fA-F]{64}$",
      "description": "Full bytes32 claim type ID"
    },
    "version": {
      "type": "string",
      "pattern": "^[0-9]+\\.[0-9]+$",
      "default": "1.0",
      "description": "Schema version"
    },
    "issuer": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Official name of the issuing authority",
          "examples": ["Oregon Department of Motor Vehicles"]
        },
        "address": {
          "type": "string",
          "pattern": "^0x[0-9a-fA-F]{40}$",
          "description": "Ethereum address of the issuer"
        },
        "url": {
          "type": "string",
          "format": "uri",
          "description": "Official website of the issuer",
          "examples": ["https://www.oregon.gov/odot/dmv"]
        },
        "logo": {
          "type": "string",
          "format": "uri",
          "description": "IPFS URI or HTTPS URL for issuer logo",
          "examples": ["ipfs://Qm.../oregon-dmv-logo.png"]
        },
        "jurisdiction": {
          "type": "string",
          "description": "Geographic/legal jurisdiction code",
          "examples": ["US-OR", "US", "EU-DE"]
        },
        "contact": {
          "type": "object",
          "properties": {
            "email": {
              "type": "string",
              "format": "email"
            },
            "phone": {
              "type": "string"
            }
          }
        }
      }
    },
    "subject": {
      "type": "object",
      "description": "Information about the credential subject (optional, may be encrypted)",
      "properties": {
        "type": {
          "type": "string",
          "enum": ["person", "organization", "asset", "other"],
          "description": "Type of subject"
        },
        "identifier": {
          "type": "string",
          "description": "Hashed or encrypted identifier"
        }
      }
    },
    "displayFields": {
      "type": "array",
      "description": "Fields to display in wallet/viewer UI",
      "items": {
        "type": "object",
        "required": ["name", "path"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Display label for the field",
            "examples": ["License Class", "Expiration Date"]
          },
          "path": {
            "type": "string",
            "description": "JSONPath to the value in decrypted payload",
            "examples": ["$.class", "$.expiresAt"]
          },
          "format": {
            "type": "string",
            "enum": ["text", "date", "datetime", "number", "currency", "list", "boolean", "address", "image"],
            "default": "text",
            "description": "How to format the value for display"
          },
          "private": {
            "type": "boolean",
            "default": false,
            "description": "Whether this field requires decryption to view"
          }
        }
      }
    },
    "disclosureSchemas": {
      "type": "object",
      "description": "Schemas for supported ZK disclosure types",
      "additionalProperties": {
        "type": "object",
        "required": ["description", "fields"],
        "properties": {
          "description": {
            "type": "string",
            "description": "Human-readable description of what this disclosure proves"
          },
          "fields": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Fields involved in this disclosure"
          },
          "circuitId": {
            "type": "string",
            "description": "Identifier of the ZK circuit used"
          },
          "publicInputs": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Names of public inputs for the circuit"
          }
        }
      },
      "examples": [{
        "AGE_THRESHOLD": {
          "description": "Prove age above or below threshold",
          "fields": ["birthdate"],
          "circuitId": "AgeThreshold",
          "publicInputs": ["threshold", "comparisonType", "currentTimestamp"]
        }
      }]
    },
    "payloadSchema": {
      "type": "object",
      "description": "JSON Schema for the encrypted payload structure",
      "properties": {
        "$schema": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "properties": {
          "type": "object"
        },
        "required": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "validityRules": {
      "type": "object",
      "description": "Rules for credential validity",
      "properties": {
        "renewable": {
          "type": "boolean",
          "default": true,
          "description": "Whether credential can be renewed"
        },
        "gracePeriodDays": {
          "type": "integer",
          "default": 90,
          "description": "Days after expiration during which renewal is allowed"
        },
        "transferable": {
          "type": "boolean",
          "default": false,
          "description": "Whether credential can be transferred"
        },
        "inheritable": {
          "type": "boolean",
          "default": false,
          "description": "Whether credential supports FIE inheritance"
        },
        "splittable": {
          "type": "boolean",
          "default": false,
          "description": "Whether credential can be split for partial inheritance"
        }
      }
    },
    "natlangchain": {
      "type": "object",
      "description": "NatLangChain integration data",
      "properties": {
        "intentType": {
          "type": "string",
          "const": "CREDENTIAL_ISSUANCE"
        },
        "prose": {
          "type": "string",
          "description": "Natural language statement of the claim"
        },
        "semanticTags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for semantic indexing"
        },
        "crossReferences": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "recordHash": {
                "type": "string",
                "pattern": "^0x[0-9a-fA-F]{64}$"
              },
              "relationship": {
                "type": "string",
                "enum": ["SUPERSEDES", "AMENDS", "SUPPORTS", "REFERENCES", "REPLACES"]
              },
              "prose": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "localization": {
      "type": "object",
      "description": "Localized strings for different languages",
      "additionalProperties": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "displayFields": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            }
          }
        }
      }
    },
    "extensions": {
      "type": "object",
      "description": "Custom extension data",
      "additionalProperties": true
    }
  },
  "examples": [
    {
      "name": "Oregon Driver's License",
      "description": "Class C motor vehicle operator license issued by Oregon DMV",
      "image": "ipfs://Qm.../license-template.png",
      "claimType": "LICENSE_OPERATOR",
      "version": "1.0",
      "issuer": {
        "name": "Oregon Department of Motor Vehicles",
        "url": "https://www.oregon.gov/odot/dmv",
        "logo": "ipfs://Qm.../oregon-dmv-logo.png",
        "jurisdiction": "US-OR"
      },
      "displayFields": [
        { "name": "License Class", "path": "$.class" },
        { "name": "Expiration", "path": "$.expiresAt", "format": "date" },
        { "name": "Endorsements", "path": "$.endorsements", "format": "list" }
      ],
      "disclosureSchemas": {
        "AGE_THRESHOLD": {
          "description": "Prove age above or below threshold",
          "fields": ["birthdate"],
          "circuitId": "AgeThreshold"
        },
        "LICENSE_VALID": {
          "description": "Prove license is currently valid",
          "fields": ["expiresAt", "status"],
          "circuitId": "DateRange"
        }
      },
      "validityRules": {
        "renewable": true,
        "gracePeriodDays": 90,
        "transferable": false,
        "inheritable": false
      }
    }
  ]
}
